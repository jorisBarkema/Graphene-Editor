(this["webpackJsonpgraphene-editor"]=this["webpackJsonpgraphene-editor"]||[]).push([[0],{127:function(e,t,n){},128:function(e,t,n){"use strict";n.r(t);var o=n(1),i=n(0),a=n.n(i),s=n(27),r=n.n(s),c=n(70),l=n(48),d=n.n(l),u=n(71),p=n(59),h=n(13),f=n(15),m=n(14),g=n(31),b=n(12),v=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var i;return Object(h.a)(this,n),(i=t.call(this,e)).render=function(){return[Object(o.jsx)(b.a,{x:i.props.x,y:i.props.y,radius:15/i.props.scale,fill:i.state.hovered?i.getColor():"",onMouseEnter:function(){return i.setState({hovered:!0})},onMouseLeave:function(){return i.setState({hovered:!1})},onClick:function(){return i.handleClick()},perfectDrawEnabled:!1}),Object(o.jsx)(b.a,{x:i.props.x,y:i.props.y,radius:8/i.props.scale,fill:i.getColor(),onMouseEnter:function(){return i.setState({hovered:!0})},onMouseLeave:function(){return i.setState({hovered:!1})},onMouseDown:function(){return i.handleClick()},perfectDrawEnabled:!1})]},i.getColor=function(){return i.props.selected?"red":"black"},i.updateScale=function(e){i.setState({scale:e})},i.handleClick=function(){console.log("Selected atom "+i.props.id),i.props.addToSelection(i.props.id)},i.state={hovered:!1,scale:e.scale},i}return n}(a.a.Component),x=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var i;return Object(h.a)(this,n),(i=t.call(this,e)).render=function(){return[Object(o.jsx)(b.c,{points:i.props.points,stroke:i.state.hovered?i.getColor():"",strokeWidth:12/i.props.scale,onMouseEnter:function(){return i.setState({hovered:!0})},onMouseLeave:function(){return i.setState({hovered:!1})},onMouseDown:function(){return i.handleClick()},perfectDrawEnabled:!1}),Object(o.jsx)(b.c,{points:i.props.points,stroke:i.getColor(),strokeWidth:(i.state.hovered?5:4)/i.props.scale,onMouseEnter:function(){return i.setState({hovered:!0})},onMouseLeave:function(){return i.setState({hovered:!1})},onMouseDown:function(){return i.handleClick()},perfectDrawEnabled:!1})]},i.getColor=function(){return i.props.selected?"red":"black"},i.updateScale=function(e){},i.handleClick=function(){console.log("Selected connection "+i.props.id),i.props.addToSelection(i.props.id)},i.state={hovered:!1},i}return n}(a.a.Component),y=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var i;return Object(h.a)(this,n),(i=t.call(this,e)).render=function(){return Object(o.jsxs)("div",{id:"canvas-container",children:[Object(o.jsx)("div",{id:"coord-container",children:Object(o.jsxs)("span",{children:[-i.state.dragged.x.toFixed(2),", ",-i.state.dragged.y.toFixed(2)]})}),Object(o.jsxs)(b.e,{width:i.state.totalWidth,height:i.state.totalHeight,scaleX:i.defaultScale,scaleY:i.defaultScale,ref:function(e){return i.stage=e},children:[Object(o.jsxs)(b.b,{x:i.state.centeringX,y:i.state.centeringY,children:[Object(o.jsx)(b.d,{width:i.props.width,height:i.props.height,stroke:"black",strokeWidth:.02,fill:"rgb(220, 220, 220)"}),i.props.connections.map((function(e){return i.getConnectionData(e).map((function(e){return Object(o.jsx)(x,{id:e.id,scale:i.getCurrentScale(),points:e.points,selected:"connection"===i.props.selection.type&&i.props.selection.id===e.id,addToSelection:function(e){return i.props.addConnectionToSelection(e)}},e.key)}))})),i.props.atoms.map((function(e){var t=i.coordinateToScreenCoordinate(e.x,e.y);return Object(o.jsx)(v,{id:e.id,scale:i.getCurrentScale(),x:t.x,y:t.y,selected:"atom"===i.props.selection.type&&i.props.selection.ids.includes(e.id),addToSelection:function(e){return i.props.addAtomToSelection(e)}},e.id)}))]}),Object(o.jsxs)(b.b,{listening:!1,children:[Object(o.jsx)(b.d,{width:i.state.centeringX,height:10*i.props.height,fill:"#fff"}),Object(o.jsx)(b.d,{x:i.state.centeringX+i.props.width,width:i.state.centeringX,height:10*i.props.height,fill:"#fff"}),Object(o.jsx)(b.d,{width:10*i.props.width,height:i.state.centeringY,fill:"#fff"}),Object(o.jsx)(b.d,{y:i.state.centeringY+i.props.height,width:10*i.props.width,height:i.state.centeringY,fill:"#fff"})]})]})]})},i.componentDidMount=function(){var e=document.getElementById("canvas-container");e.addEventListener("click",i.handleClick),window.addEventListener("resize",i.onResize),e.addEventListener("wheel",i.zoomStage),e.addEventListener("mousedown",i.startDragging),window.addEventListener("mouseup",i.stopDragging),window.addEventListener("mousemove",i.dragMove),window.addEventListener("keydown",i.handleKeyDown),window.addEventListener("keyup",i.handleKeyUp),i.createCanvas()},i.createCanvas=function(){var e=7*window.innerWidth/8/i.props.width,t=7*window.innerHeight/8/i.props.height;i.defaultScale=Math.max(40,Math.min(e,t)),i.setState({offsetx:i.props.width/2,offsety:i.props.height/2,currentScale:i.defaultScale,minScale:i.defaultScale,centeringX:0,centeringY:0},(function(){var e=i.getScreenPositionFromStage(i.props.width/2,i.props.height/2);i.setState({centeringX:(window.innerWidth-e.x+i.menuWidth)/i.state.currentScale/2,centeringY:(window.innerHeight-e.y)/i.state.currentScale/2},(function(){console.log("Created canvas")}))}))},i.startDragging=function(e){i.setState({dragStart:i.getStagePositionFromScreen(e.pageX,e.pageY)},(function(){i.setState({dragging:!0})}))},i.dragMove=function(e){if(i.state.dragging){var t=i.state.dragStart,n=i.getStagePositionFromScreen(e.pageX,e.pageY);if(i.state.moveMode)i.setState({dragStart:n}),i.props.moveSelectedAtoms(n.x-t.x,n.y-t.y);else{for(var o=i.state.dragged.x+n.x-t.x,a=i.state.dragged.y+n.y-t.y;o<-i.props.width/2;)o+=i.props.width;for(;o>i.props.width/2;)o-=i.props.width;for(;a<-i.props.height/2;)a+=i.props.height;for(;a>i.props.height/2;)a-=i.props.height;i.setState({dragged:{x:o,y:a},dragStart:n})}}},i.stopDragging=function(e){i.props.updateSquares(),i.setState({dragging:!1},(function(){}))},i.centerOnItem=function(e,t){if("atom"===e){var n=i.props.atoms[i.atomIndexByID(t)];i.centerOnLocation(n.x,n.y)}if("connection"===e){var o=i.props.connections[i.connectionIndexByID(t)],a=i.props.atoms[i.atomIndexByID(o.a)];i.centerOnLocation(a.x,a.y)}},i.centerOnLocation=function(e,t){i.setState({dragged:{x:-e,y:-t}},(function(){return i.props.updateSquares()}))},i.zoomStage=function(e){if(!i.state.mouseOverMenu&&!i.state.mouseOverTimeline&&null!==i.stage){var t=1;e.deltaY<0&&(t+=.4),e.deltaY>0&&(t-=.4);var n=i.getCurrentScale()*t;i.zoomStageTo((window.innerWidth-i.menuWidth)/2+i.menuWidth,window.innerHeight/2,n)}},i.zoomStageTo=function(e,t,n){if(n<i.state.minScale&&(n=i.state.minScale),null!==i.stage){var o=i.getCurrentScale(),a=i.getCurrentPosition(),s=[e-(e-a.x)*n/o,t-(t-a.y)*n/o];i.setState({currentScale:n}),i.stage.to({scaleX:n,scaleY:n,x:s[0],y:s[1],duration:.1,onFinish:function(){}})}},i.handleClick=function(e){},i.handleKeyDown=function(e){"KeyQ"===e.code&&(i.state.moveMode||i.setState({moveMode:!0}))},i.handleKeyUp=function(e){"KeyQ"===e.code&&i.setState({moveMode:!1})},i.getStagePositionFromScreen=function(e,t){var n=i.getCurrentScale(),o=i.getCurrentPosition(),a=(e-o.x)/n,s=(t-o.y)/n;return{x:a-i.state.offsetx-i.state.centeringX,y:s-i.state.offsety-i.state.centeringY}},i.getScreenPositionFromStage=function(e,t){var n=i.getCurrentScale(),o=i.getCurrentPosition(),a=(e+i.state.offsetx+i.state.centeringX)*n,s=(t+i.state.offsety+i.state.centeringY)*n;return{x:a+o.x,y:s+o.y}},i.connectionIndexByID=function(e){for(var t=0;t<i.props.connections.length;t++)if(i.props.connections[t].id===e)return t;return null},i.atomIndexByID=function(e){for(var t=0;t<i.props.atoms.length;t++)if(i.props.atoms[t].id===e)return t;return null},i.getConnectionData=function(e){var t=i.props.atoms[i.atomIndexByID(e.a)],n=i.props.atoms[i.atomIndexByID(e.b)],o=Object(g.a)({},t),a=Object(g.a)({},n),s=!1,r=i.coordinateToScreenCoordinate(t.x,t.y),c=i.coordinateToScreenCoordinate(a.x,a.y),l=i.coordinateToScreenCoordinate(o.x,o.y),d=i.coordinateToScreenCoordinate(n.x,n.y),u=c.x-r.x,p=c.y-r.y;u>i.props.width/2?(c.x-=i.props.width,l.x+=i.props.width,s=!0):u<-i.props.width/2&&(c.x+=i.props.width,l.x-=i.props.width,s=!0),p>i.props.height/2?(c.y-=i.props.height,l.y+=i.props.height,s=!0):p<-i.props.height/2&&(c.y+=i.props.height,l.y-=i.props.height,s=!0);var h=[{key:e.id,id:e.id,points:[r.x,r.y,c.x,c.y]}];return s&&h.push({key:e.id+1e10,id:e.id,points:[l.x,l.y,d.x,d.y]}),h},i.coordinateToScreenCoordinate=function(e,t){var n=(e+i.state.offsetx+i.state.dragged.x)%i.props.width,o=(t+i.state.offsety+i.state.dragged.y)%i.props.height;return{x:n=(n+i.props.width)%i.props.width,y:o=(o+i.props.height)%i.props.height}},i.onResize=function(){i.createCanvas()},i.getCurrentScale=function(){var e=i.state.currentScale;try{e=i.stage.scaleX()}catch(t){console.log("Could not get stage.scaleX()"),console.log(t)}return e},i.getCurrentPosition=function(){var e={x:0,y:0};try{e=i.stage.absolutePosition()}catch(t){console.log(t)}return e},i.defaultScale=0,i.menuWidth=280,i.state={dragging:!1,selection:{},offsetx:0,offsety:0,centeringX:0,centeringY:0,totalWidth:window.innerWidth,totalHeight:window.innerHeight,currentScale:i.defaultScale,minScale:i.defaultScale,dragStart:{x:0,y:0},dragged:{x:0,y:0},moveMode:!1},i.stage=a.a.createRef(),i}return n}(a.a.Component),j=n(145),S=n(63),O=n.n(S),w=n(64),C=n.n(w),I=n(66),T=n.n(I),B=n(65),A=n.n(B),D=n(68),k=n.n(D),N=n(67),E=n.n(N),z=n(49),M=n.n(z),F=n(69),L=n.n(F),q=n(61),R=n(43),Y=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var o;return Object(h.a)(this,n),(o=t.call(this,e)).startUpload=function(){o.uploader.click()},o.uploadFile=o.uploadFile.bind(Object(R.a)(o)),o.uploader=a.a.createRef(),o}return Object(q.a)(n,[{key:"uploadFile",value:function(e){var t=this,n=e.target.files[0];n&&n.text().then((function(e){t.props.loadText(e),document.getElementsByName("fileInput")[0].value=""}))}},{key:"render",value:function(){var e=this;return Object(o.jsx)("span",{id:"file-upload-container",children:Object(o.jsx)("input",{type:"file",name:"fileInput",ref:function(t){return e.uploader=t},onChange:this.uploadFile})})}}]),n}(a.a.Component),P=n(147),W=n(146),X=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(h.a)(this,n);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).render=function(){return Object(o.jsx)("div",{className:"warning",children:Object(o.jsxs)(P.a,{severity:"warning",action:Object(o.jsx)(W.a,{color:"inherit",size:"small",onClick:function(){return e.props.hasOwnProperty("location")?e.props.centerOnLocation(e.props.location.x,e.props.location.y):e.props.centerOnItem(e.props.type,e.props.id)},children:"VIEW"}),children:[e.props.text," at ",e.props.hasOwnProperty("location")?e.props.location.x.toFixed(2)+", "+e.props.location.y.toFixed(2):e.props.type+" "+e.props.id]})})},e.onClick=function(){console.log("test")},e}return n}(a.a.Component),H=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var s;return Object(h.a)(this,n),(s=t.call(this,e)).render=function(){return Object(o.jsx)("div",{id:"menu-container",children:Object(o.jsxs)("div",{children:[Object(o.jsxs)("div",{className:"button-container",children:[Object(o.jsxs)(j.a,{size:"medium",style:{fontSize:14},"aria-label":"add",onClick:function(){return s.props.goToAtom()},children:[Object(o.jsx)(M.a,{size:"large"}),Object(o.jsx)("span",{className:"button-text",children:"CENTER ON ATOM BY ID"})]}),Object(o.jsx)("input",{id:"id-input",name:"id-input",type:"number"})]}),Object(o.jsx)("div",{className:"button-container",children:Object(o.jsxs)(j.a,{disabled:s.selectionIsEmpty(),size:"medium",style:{fontSize:14},"aria-label":"add",onClick:function(){return s.props.centerOnSelection()},children:[Object(o.jsx)(M.a,{size:"large"}),Object(o.jsx)("span",{className:"button-text",children:"CENTER ON SELECTION"})]})}),Object(o.jsx)("div",{className:"button-container",children:Object(o.jsxs)(j.a,{disabled:!s.canAddConnection(),size:"medium",style:{fontSize:14},"aria-label":"add",onClick:function(){return s.addConnectionBetweenSelectedAtoms()},children:[Object(o.jsx)(O.a,{size:"large"}),Object(o.jsx)("span",{className:"button-text",children:"ADD CONNECTION"})]})}),Object(o.jsx)("div",{className:"button-container",children:Object(o.jsxs)(j.a,{disabled:!s.canRemoveConnection(),size:"medium",style:{fontSize:14},"aria-label":"remove",onClick:function(){return s.removeSelectedConnection()},children:[Object(o.jsx)(C.a,{size:"large"}),Object(o.jsx)("span",{className:"button-text",children:"REMOVE CONNECTION"})]})}),Object(o.jsx)("div",{className:"button-container",children:Object(o.jsxs)(j.a,{disabled:!s.canReplaceByAtom(),size:"medium",style:{fontSize:14},"aria-label":"replace-by-one",onClick:function(){return s.replaceSelectionByAtom()},children:[Object(o.jsx)(A.a,{size:"large"}),Object(o.jsx)("span",{className:"button-text",children:"REPLACE TRIO BY ATOM"})]})}),Object(o.jsx)("div",{className:"button-container",children:Object(o.jsxs)(j.a,{disabled:!s.singleAtomSelected(),size:"medium",style:{fontSize:14},"aria-label":"replace-by-three",onClick:function(){return s.replaceSelectionByTrio()},children:[Object(o.jsx)(T.a,{size:"large"}),Object(o.jsx)("span",{className:"button-text",children:"REPLACE ATOM BY TRIO"})]})}),Object(o.jsx)("div",{className:"button-container",children:Object(o.jsxs)(j.a,{size:"medium",onClick:function(){s.fileInput.startUpload()},style:{fontSize:14},"aria-label":"upload",children:[Object(o.jsx)(E.a,{size:"large"}),Object(o.jsx)("span",{className:"button-text",children:"IMPORT FILE"}),Object(o.jsx)(Y,{ref:function(e){return s.fileInput=e},loadText:function(e){return s.loadText(e)}})]})}),Object(o.jsx)("div",{className:"button-container",children:Object(o.jsxs)(j.a,{size:"medium",onClick:function(){s.downloadFile()},style:{fontSize:14},"aria-label":"download",children:[Object(o.jsx)(k.a,{size:"large"}),Object(o.jsx)("span",{className:"button-text",children:"EXPORT FILE"})]})}),Object(o.jsxs)("div",{id:"warning-container",children:[Object(o.jsx)("div",{className:"button-container",children:Object(o.jsxs)(j.a,{size:"medium",onClick:function(){s.props.checkConsistency()},style:{fontSize:14},"aria-label":"download",children:[Object(o.jsx)(L.a,{size:"large"}),Object(o.jsx)("span",{className:"button-text",children:"CHECK CONSISTENCY"})]})}),s.props.connections.length>500?Object(o.jsx)("p",{children:"Because of the size of the sample this function will only look at part of the sample."}):null,s.props.warnings.map((function(e,t){return Object(i.createElement)(X,Object(g.a)(Object(g.a)({},e),{},{key:t,centerOnLocation:function(e,t){return s.props.centerOnLocation(e,t)},centerOnItem:function(e,t){return s.props.centerOnItem(e,t)}}))}))]}),Object(o.jsxs)("div",{id:"documentation-container",children:[Object(o.jsx)("p",{children:"Add any number of atoms or a single connection to the selection by clicking on them."}),Object(o.jsx)("p",{children:"Drag the canvas to move around, hold Q and drag to move selected atoms."}),Object(o.jsxs)("p",{children:["For more information on how to use this editor, read the README on ",Object(o.jsx)("a",{href:"https://github.com/jorisBarkema/Graphene-Editor",children:"Github"})]})]})]})})},s.componentDidMount=function(){document.getElementById("id-input").addEventListener("input",(function(e){s.props.setGoToAtomID(e.target.value)}))},s.selectionIsEmpty=function(){return!("atom"===s.props.selection.type||"connection"===s.props.selection.type)},s.singleAtomSelected=function(){return"atom"===s.props.selection.type&&1===s.props.selection.ids.length},s.canReplaceByAtom=function(){return"atom"===s.props.selection.type&&3===s.props.selection.ids.length},s.connectionIndexByAtoms=function(e,t){for(var n=0;n<s.props.connections.length;n++)if(s.props.connections[n].a===e&&s.props.connections[n].b===t||s.props.connections[n].b===e&&s.props.connections[n].a===t)return n;return null},s.canAddConnection=function(){return"atom"===s.props.selection.type&&2===s.props.selection.ids.length&&null===s.connectionIndexByAtoms(s.props.selection.ids[0],s.props.selection.ids[1])},s.canRemoveConnection=function(){return"connection"===s.props.selection.type},s.removeSelectedConnection=function(){s.props.removeSelectedConnection()},s.enterMoveAtomState=function(){s.props.enterMoveAtomState()},s.addConnectionBetweenSelectedAtoms=function(){s.props.addConnectionBetweenSelectedAtoms()},s.replaceSelectionByAtom=function(){s.props.replaceSelectionByAtom()},s.replaceSelectionByTrio=function(){s.props.replaceSelectionByTrio()},s.loadText=function(e){s.props.loadText(e)},s.downloadFile=function(){s.props.downloadFile()},s.state={},s.fileInput=a.a.createRef(),s}return n}(a.a.Component),K=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var i;return Object(h.a)(this,n),(i=t.call(this,e)).totalConnections=0,i.totalAtoms=0,i.render=function(){return Object(o.jsxs)("div",{children:[Object(o.jsx)(y,{ref:function(e){return i.canvas=e},selection:i.state.selection,atoms:i.state.visibleAtoms,connections:i.state.visibleConnections,width:i.state.width,height:i.state.height,addAtomToSelection:function(e){return i.addAtomToSelection(e)},addConnectionToSelection:function(e){return i.addConnectionToSelection(e)},moveSelectedAtoms:function(e,t){return i.moveSelectedAtoms(e,t)},checkConsistency:function(){return i.checkConsistency()},updateSquares:function(){return i.updateSquares()}}),Object(o.jsx)(H,{selection:i.state.selection,atoms:i.state.atoms,connections:i.state.connections,warnings:i.state.warnings,centerOnSelection:function(){return i.centerOnSelection()},centerOnItem:function(e,t){return i.centerOnItem(e,t)},centerOnLocation:function(e,t){return i.centerOnLocation(e,t)},removeSelectedConnection:function(){return i.removeSelectedConnection()},addConnectionBetweenSelectedAtoms:function(){return i.addConnectionBetweenSelectedAtoms()},replaceSelectionByAtom:function(){return i.replaceSelectionByAtom()},replaceSelectionByTrio:function(){return i.replaceSelectionByTrio()},loadText:function(e){return i.loadText(e)},downloadFile:function(){return i.downloadFile()},checkConsistency:function(){return i.checkConsistency()},setGoToAtomID:function(e){return i.goToAtomID=e},goToAtom:function(){return i.goToAtom()}})]})},i.loadText=function(e){console.log("loading text");for(var t=e.split("\n"),n=parseFloat(t[0]),o=parseFloat(t[1]),a=[],s=[],r=4;r<t.length;r++){var c=t[r].split(/\s+/);if(4===c.length)a.push({id:parseInt(c[0]),x:parseFloat(c[1]),y:parseFloat(c[2]),z:parseFloat(c[3]),square:i.coordToSquare(parseFloat(c[1]),parseFloat(c[2]),n,o)}),i.totalAtoms++;else if(3===c.length){var l=parseInt(c[1]),d=parseInt(c[2]);s.push({id:parseInt(c[0]),a:l,b:d}),i.totalConnections++}}i.setState({atoms:a,connections:s,width:n,height:o,warnings:[],selection:{}},(function(){i.canvas.createCanvas(),i.updateSquares()}))},i.downloadFile=function(){var e="";e+=i.state.width+"\n",e+=i.state.height+"\n",e+="\n\n";for(var t=0;t<i.state.atoms.length;t++){var n=i.state.atoms[t];e+=n.id+" "+n.x+" "+n.y+" "+n.z+"\n"}for(var o=0;o<i.state.connections.length;o++){var a=i.state.connections[o];e+=a.id+" "+a.a+" "+a.b+"\n"}var s=document.createElement("a");s.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),s.setAttribute("download","graphene-sample"),s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s)},i.checkConsistency=Object(p.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(t=(t=[]).concat(i.checkAllThreeConnections())).concat(i.checkNoIntersections()),t=Object(u.a)(new Set(t)),i.setState({warnings:t});case 5:case"end":return e.stop()}}),e)}))),i.checkAllThreeConnections=function(){for(var e=[],t=i.state.connections,n={},o=0;o<t.length;o++){var a=t[o];a.a in n?n[a.a]++:n[a.a]=1,a.b in n?n[a.b]++:n[a.b]=1}for(var s=0,r=Object.entries(n);s<r.length;s++){var l=Object(c.a)(r[s],2),d=l[0],u=l[1];u<3&&e.push({id:d,type:"atom",text:"Too few connections"}),u>3&&e.push({id:d,type:"atom",text:"Too many connections"})}return e},i.checkNoIntersections=function(){for(var e=i.state.connections.length>500?i.state.visibleConnections:i.state.connections,t=i.state.atoms,n=[],o=0;o<e.length;o++)for(var a=o+1;a<e.length;a++){var s=e[o],r=e[a];if(!(s.a===r.a||s.a===r.b||s.b===r.a|s.b===r.b)){var c=t[i.atomIndexByID(s.a)],l=t[i.atomIndexByID(s.b)],d=i.closestToNumber(c.x,[l.x,l.x-i.state.width,l.x+i.state.width]),u=i.closestToNumber(c.y,[l.y,l.y-i.state.height,l.y+i.state.height]),p=t[i.atomIndexByID(r.a)],h=t[i.atomIndexByID(r.b)],f=i.closestToNumber(p.x,[h.x,h.x-i.state.width,h.x+i.state.width]),m=i.closestToNumber(p.y,[h.y,h.y-i.state.height,h.y+i.state.height]),g=i.lines_intersect(c.x,c.y,d,u,p.x,p.y,f,m);g&&n.push({location:g,text:"Crossing lines between connections ".concat(s.id," and ").concat(r.id)})}}return n},i.updateSquares=function(){i.setState({squares:i.currentSquares()},(function(){var e=i.visibleAtoms();i.setState({visibleAtoms:e,visibleConnections:i.visibleConnections(e)})}))},i.visibleAtoms=function(){for(var e=i.state.atoms.filter((function(e){return i.state.squares.rows.includes(e.square.row)&&i.state.squares.columns.includes(e.square.column)})),t=[],n=0;n<i.state.connections.length;n++){var o=i.state.connections[n],a=i.state.atoms[i.atomIndexByID(o.a)],s=i.state.atoms[i.atomIndexByID(o.b)];!e.includes(a)||e.includes(s)||t.includes(s)||t.push(s),!e.includes(s)||e.includes(a)||t.includes(a)||t.push(a)}return e.concat(t)},i.visibleConnections=function(e){var t=e.map((function(e){return e.id}));return i.state.connections.filter((function(e){return t.includes(e.a)&&t.includes(e.b)}))},i.coordToSquare=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.state.width,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.state.height;e<-n/2;)e+=n;for(;e>n/2;)e-=n;for(;t<-o/2;)t+=o;for(;t>o/2;)t-=o;return{row:Math.round(t/i.squareHeight),column:Math.round(e/i.squareWidth)}},i.currentSquares=function(){if(null===i.canvas)return{rows:[0],columns:[0]};for(var e=-i.canvas.state.dragged.x,t=-i.canvas.state.dragged.y;e<-i.state.width/2;)e+=i.state.width;for(;e>i.state.width/2;)e-=i.state.width;for(;t<-i.state.height/2;)t+=i.state.height;for(;t>i.state.height/2;)t-=i.state.height;for(var n=[],o=[],a=-6;a<=6;a++)for(var s=-3;s<=3;s++){var r=i.coordToSquare(e+a*i.squareWidth,t+s*i.squareHeight);n.includes(r.row)||n.push(r.row),o.includes(r.column)||o.push(r.column)}return{rows:n,columns:o}},i.lines_intersect=function(e,t,n,o,i,a,s,r){if(e===n&&t===o||i===s&&a===r)return!1;var c=(r-a)*(n-e)-(s-i)*(o-t);if(0===c)return!1;var l=((s-i)*(t-a)-(r-a)*(e-i))/c,d=((n-e)*(t-a)-(o-t)*(e-i))/c;return!(l<0||l>1||d<0||d>1)&&{x:e+l*(n-e),y:t+l*(o-t)}},i.addAtomToSelection=function(e){var t=i.state.selection;if("atom"===t.type){if(t.ids.includes(e)){var n=t.ids.indexOf(e);t.ids.splice(n,1)}else t.ids.push(e);i.setState({selection:t.ids.length>0?t:{}})}else i.setState({selection:{type:"atom",ids:[e]}})},i.addConnectionToSelection=function(e){var t=i.state.selection;"connection"===t.type&&t.id===e?i.setState({selection:{}}):i.setState({selection:{type:"connection",id:e}})},i.moveSelectedAtoms=function(e,t){var n=i.state.selection;if("connection"!==n.type)for(var o=i.state.atoms,a=0;a<n.ids.length;a++){var s=o[i.atomIndexByID(n.ids[a])];s.x+=e,s.y+=t}},i.centerOnSelection=function(){var e=i.state.selection,t=0;"atom"===e.type&&(t=e.ids[0]),"connection"===e.type&&(t=e.id),i.centerOnItem(e.type,t)},i.goToAtom=function(){Number.isNaN(i.goToAtomID)||null!==i.atomIndexByID(parseInt(i.goToAtomID))&&i.canvas.centerOnItem("atom",parseInt(i.goToAtomID))},i.centerOnItem=function(e,t){i.canvas.centerOnItem(e,parseInt(t))},i.centerOnLocation=function(e,t){i.canvas.centerOnLocation(e,t)},i.removeSelectedConnection=function(){var e=i.state.selection.id;i.removeConnectionByID(e)},i.removeConnectionByID=function(e){var t=i.connectionIndexByID(e),n=i.state.connections,o=i.state.atoms;n.splice(t,1),i.setState({selection:{},connections:n,atoms:o},(function(){}))},i.removeAtomByID=function(e){var t=i.atomIndexByID(e),n=i.state.atoms;n.splice(t,1),i.setState({selection:{},atoms:n},(function(){}))},i.addConnectionBetweenSelectedAtoms=function(){var e=i.state.connections,t=i.state.atoms,n=i.state.selection.ids[0],o=i.state.selection.ids[1];e.push({id:i.totalConnections++,a:n,b:o}),i.setState({connections:e,atoms:t},(function(){}))},i.addConnectionBetweenAtoms=function(e,t){var n=i.state.connections,o=i.state.atoms;n.push({id:i.totalConnections++,a:e.id,b:t.id}),i.setState({connections:n,atoms:o},(function(){}))},i.closestToNumber=function(e,t){for(var n=t[0],o=Math.abs(t[0]-e),i=0;i<t.length;i++)Math.abs(t[i]-e)<o&&(n=t[i],o=Math.abs(t[i]-e));return n},i.distanceBetween=function(e,t){return i.distanceTo(e,t.x,t.y)},i.distanceTo=function(e,t,n){var o=i.closestToNumber(t,[e.x,e.x-i.state.width,e.x+i.state.width]),a=i.closestToNumber(n,[e.y,e.y-i.state.height,e.y+i.state.height]);return Math.sqrt((t-o)*(t-o)+(n-a)*(n-a))},i.closestAtom=function(e,t){for(var n=i.state.atoms[0],o=1e10,a=0;a<i.state.atoms.length;a++){var s=i.distanceTo(i.state.atoms[a],e,t);s<o&&(o=s,n=i.state.atoms[a])}return n},i.replaceSelectionByAtom=function(){for(var e=i.state.atoms,t=i.state.connections,n=i.totalAtoms,o=i.state.selection.ids,a={x:0,y:0,z:0},s=0,r=0,c=0,l=0;l<o.length;l++){var d=i.atomIndexByID(o[l]),u=e[d];a={x:(s+=i.closestToNumber(a.x,[u.x,u.x-i.state.width,u.x+i.state.width])/3)*(3-l),y:(r+=i.closestToNumber(a.y,[u.y,u.y-i.state.height,u.y+i.state.height])/3)*(3-l),z:(c+=u.z/3)*(3-l)},e.splice(d,1)}e.push({id:n,x:s,y:r,z:c});for(var p=[],h=0;h<i.state.selection.ids.length;h++)for(var f=i.state.selection.ids[h],m=t.length-1;m>=0;m--){var g=t[m];g.a===f&&(p.includes(g.b)?i.removeConnectionByID(g.id):(g.a=n,p.push(g.b))),g.b===f&&(p.includes(g.a)?i.removeConnectionByID(g.id):(g.b=n,p.push(g.a)))}i.totalAtoms++,i.setState({selection:{},atoms:e,connections:t},(function(){}))},i.replaceSelectionByTrio=function(){for(var e=i.state.atoms,t=i.state.connections,n=i.state.selection.ids[0],o=1e10,a=0;a<t.length;a++){var s=t[a];if(s.a===n){var r=i.distanceBetween(e[i.atomIndexByID(n)],e[i.atomIndexByID(s.b)]);r<o&&(o=r)}if(s.b===n){var c=i.distanceBetween(e[i.atomIndexByID(n)],e[i.atomIndexByID(s.a)]);c<o&&(o=c)}}var l=e[i.atomIndexByID(n)];i.removeAtomByID(n);var d=l.x,u=l.y,p=l.z,h={id:i.totalAtoms++,x:d+o/2,y:u,z:p},f={id:i.totalAtoms++,x:d-o/2,y:u,z:p},m={id:i.totalAtoms++,x:d,y:u-o/2,z:p};e.push(h),e.push(f),e.push(m),i.addConnectionBetweenAtoms(h,f),i.addConnectionBetweenAtoms(f,m),i.addConnectionBetweenAtoms(m,h);for(var g=0;g<t.length;g++){var b=t[g],v=null;if(b.a===n&&(v=b.b),b.b===n&&(v=b.a),null!==v){var x=e[i.atomIndexByID(v)],y=h,j=i.distanceBetween(x,h);i.distanceBetween(x,f)<j&&(y=f,j=i.distanceBetween(x,f)),i.distanceBetween(x,m)<j&&(y=m),b.a===n&&(b.a=y.id),b.b===n&&(b.b=y.id)}}i.setState({selection:{},atoms:e,connections:t},(function(){}))},i.connectionIndexByID=function(e){for(var t=0;t<i.state.connections.length;t++)if(i.state.connections[t].id===e)return t;return null},i.atomIndexByID=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null===t&&(t=i.state.atoms);for(var n=0;n<t.length;n++)if(t[n].id===e)return n;return null},i.squareHeight=2.8,i.squareWidth=2.8,i.goToAtomID=NaN,i.state={selection:{},atoms:[],connections:[],squares:{rows:[],columns:[]},visibleAtoms:[],visibleConnections:[],width:5,height:5,warnings:[]},i.canvas=a.a.createRef(),i}return n}(a.a.Component),U=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,148)).then((function(t){var n=t.getCLS,o=t.getFID,i=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),o(e),i(e),a(e),s(e)}))};n(127);r.a.render(Object(o.jsx)(a.a.StrictMode,{children:Object(o.jsx)(K,{})}),document.getElementById("root")),U()}},[[128,1,2]]]);
//# sourceMappingURL=main.a869401f.chunk.js.map